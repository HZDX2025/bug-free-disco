<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>汉责官方网站</title>
    
    <!-- 性能优化：DNS 预解析 -->
    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">
    <link rel="dns-prefetch" href="https://unpkg.com">
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>

    <style>
        /* 极致性能首屏样式：确保瞬间渲染背景 */
        :root { --bg: #010101; --accent: #6366f1; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background-color: var(--bg); 
            color: #fff; 
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        /* 极简加载层：仅用于衔接 React 挂载过程 */
        #initial-loader {
            position: fixed; inset: 0; background: var(--bg);
            display: flex; align-items: center; justify-content: center;
            z-index: 99999; 
            transition: opacity 0.4s ease-out; /* 缩短渐变时间 */
        }

        .loader-logo {
            font-family: serif; font-size: 2.5rem; font-weight: bold;
            letter-spacing: 0.2em;
            color: #fff;
            opacity: 0.8;
        }

        /* 全局动画定义 */
        .animate-fade-in { animation: fadeIn 0.5s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>

    <!-- 核心依赖库 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Ma+Shan+Zheng&display=swap" rel="stylesheet">

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.263.1",
        "firebase/app": "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"
      }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style type="text/tailwindcss">
        @layer components {
            .font-shufa { font-family: 'Ma Shan Zheng', serif; }
            .glass-card { @apply bg-zinc-900/70 border border-white/5 backdrop-blur-xl; }
            .boss-card { border-color: rgba(245,158,11,0.25); background: linear-gradient(165deg, rgba(20,20,22,1) 0%, rgba(45,35,15,1) 100%); }
            .strict-card { border-color: rgba(99,102,241,0.25); background: linear-gradient(165deg, rgba(20,20,22,1) 0%, rgba(15,20,45,1) 100%); }
            .no-scrollbar::-webkit-scrollbar { display: none; }
        }
    </style>
</head>
<body class="bg-[#010101]">
    <!-- 极速首屏占位 -->
    <div id="initial-loader">
        <div class="loader-logo font-shufa">汉责</div>
    </div>
    
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo, useRef, memo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Search, X, Building2, Crown, Gavel, Quote, Pencil, 
            Save, RotateCcw, ShieldAlert, LogOut, Settings, 
            CheckCircle2, AlertCircle, Lock, ChevronRight, Plus, Camera, RefreshCw, 
            Image as ImageIcon, Upload, AlertTriangle, Edit3, Trash2, Wallet, QrCode, 
            Heart, Layers, Star, ShieldCheck, BookOpen, Terminal, DollarSign, ArrowLeft, Zap
        } from 'lucide-react';

        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
        import { getFirestore, doc, setDoc, onSnapshot, updateDoc, collection, deleteDoc, enableIndexedDbPersistence } from 'firebase/firestore';

        // --- Firebase 配置 ---
        const firebaseConfig = {
            apiKey: "AIzaSyB0hEE4vGfJHTfzsjQXMADLNN6CHFwNXfo",
            authDomain: "hanzi-b4d62.firebaseapp.com",
            projectId: "hanzi-b4d62",
            storageBucket: "hanzi-b4d62.firebasestorage.app",
            messagingSenderId: "281571520592",
            appId: "1:281571520592:web:6dbf51cec514ff3a5b6155",
            measurementId: "G-H5D084JP0S"
        };

        const appId = 'hanze-official-v3-final-stable';
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // 离线持久化
        try {
            enableIndexedDbPersistence(db).catch(() => {});
        } catch(e) {}

        const ADMIN_PASSWORD = "admin888";
        
        const CATEGORIES = [
            { id: 'all', name: '全员档案', icon: <Layers size={18}/> },
            { id: 'boss', name: 'BOSS 监督', icon: <Crown size={18}/> },
            { id: 'strict', name: '严厉监督', icon: <Gavel size={18}/> }
        ];

        const INITIAL_CONFIG = {
            landing: { 
                mainTitle: "汉责", 
                stampText: "督学", 
                subTitle: "汉责工作室官方网站", 
                description: "以责为重，以墨为锋。拒绝平庸的自律，开启深度督学时代的革新之旅。", 
                enterButton: "进入汉责督学", 
                footer: "汉责工作室 · 2024-2025" 
            },
            header: { title: "汉责官方网站", subtitle: "官方管理界面" },
            about: {
                title: "品牌叙事",
                description: "汉责工作室专注于建立高效的高压督导环境。我们通过建立精神契约、实时轨迹追踪，帮助学员在激烈的竞争中重获绝对掌控力。",
                achievements: [ { label: "累计时长", value: "18,600+", unit: "小时" }, { label: "上岸人数", value: "920+", unit: "人" }, { label: "评分", value: "4.99", unit: "/ 5.0" } ]
            },
            teamPage: { title: "监督团队", subtitle: "经严格认证的监督执剑人名单。" },
            pricing: { title: "价格列表", categories: [ { id: "cat_p1", name: "监督契约分类", options: [ { price: "299", unit: "周", desc: "方案描述示例。" } ] } ] },
            payment: { wechatQr: "", alipayQr: "" }
        };

        // --- 子组件 ---

        function StatusIndicator({ status }) {
            const cfg = { available: { color: 'bg-emerald-500', label: '在岗' }, busy: { color: 'bg-amber-500', label: '忙碌' }, away: { color: 'bg-zinc-500', label: '离线' } };
            const item = cfg[status] || cfg.available;
            return (
                <div className="flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-black/80 border border-white/10 backdrop-blur-sm shadow-xl">
                    <div className={`w-1.5 h-1.5 rounded-full ${item.color} animate-pulse`}></div>
                    <span className="text-[9px] font-black text-white/90 tracking-tighter uppercase">{item.label}</span>
                </div>
            );
        }

        function StarRating({ rating = 5 }) {
            return (
                <div className="flex items-center gap-0.5">
                    {[1, 2, 3, 4, 5].map(i => (
                        <Star key={i} size={10} fill={i <= rating ? "currentColor" : "none"} className={i <= rating ? "text-amber-500" : "text-zinc-800"} />
                    ))}
                </div>
            );
        }

        function ToastComp({ msg, onClose }) {
            useEffect(() => { const t = setTimeout(onClose, 3000); return () => clearTimeout(t); }, [onClose]);
            return (
                <div className={`fixed bottom-10 left-1/2 -translate-x-1/2 px-10 py-4 rounded-full shadow-2xl text-white font-black flex items-center gap-4 z-[99999] animate-fade-up border border-white/10 ${msg.type === 'error' ? 'bg-red-700' : 'bg-indigo-700'}`}>
                    {msg.type === 'error' ? <AlertTriangle size={20}/> : <CheckCircle2 size={20}/>}
                    <span className="text-sm tracking-[0.2em]">{msg.message}</span>
                </div>
            );
        }

        function AddMemberModal({ onClose, onAdd, handleFileAction }) {
            const [form, setForm] = useState({ name: '', category: 'strict', role: '', bio: '', photo: '' });
            return (
                <div className="fixed inset-0 bg-black/95 z-[5000] flex items-center justify-center p-6 animate-in fade-in duration-300" onClick={onClose}>
                    <div onClick={e => e.stopPropagation()} className="bg-zinc-950 border border-zinc-800 w-full max-w-lg rounded-[3rem] p-10 space-y-6 shadow-2xl text-white">
                        <h2 className="text-xl font-black uppercase tracking-tighter italic text-center">录入新监督员</h2>
                        <div className="flex flex-col items-center gap-4">
                            <div onClick={() => document.getElementById('new-av-input').click()} className="w-24 h-24 rounded-3xl border-2 border-dashed border-zinc-700 flex items-center justify-center cursor-pointer hover:border-indigo-500 overflow-hidden relative group">
                                {form.photo ? <img src={form.photo} className="w-full h-full object-cover"/> : <Camera size={24}/>}
                                <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity"><Upload size={16}/></div>
                            </div>
                            <input id="new-av-input" type="file" hidden accept="image/*" onChange={e => handleFileAction(e, (res) => setForm({...form, photo: res}))} />
                        </div>
                        <div className="space-y-4">
                            <input className="w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-sm outline-none text-white focus:border-indigo-500" placeholder="监督员姓名" value={form.name} onChange={e => setForm({...form, name: e.target.value})} />
                            <select className="w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-sm outline-none text-white focus:border-indigo-500" value={form.category} onChange={e => setForm({...form, category: e.target.value})}>
                                <option value="strict">严厉监督</option><option value="boss">BOSS 监督</option>
                            </select>
                            <input className="w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-sm outline-none text-white focus:border-indigo-500" placeholder="职位" value={form.role} onChange={e => setForm({...form, role: e.target.value})} />
                            <textarea className="w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-sm h-24 outline-none resize-none text-white focus:border-indigo-500" placeholder="简介" value={form.bio} onChange={e => setForm({...form, bio: e.target.value})} />
                        </div>
                        <button onClick={() => onAdd(form)} className="w-full py-4 bg-indigo-600 rounded-2xl font-black uppercase active:scale-95 shadow-xl transition-all">同步档案</button>
                    </div>
                </div>
            );
        }

        function MasterConsoleModal({ config, setConfig, onClose, saveConfigToCloud, handleFileAction, fileRefs }) {
            const [tab, setTab] = useState('price');
            const updatePricing = (catIndex, optIndex, field, value) => {
                const newCategories = JSON.parse(JSON.stringify(config.pricing.categories));
                if (optIndex === null) newCategories[catIndex][field] = value;
                else newCategories[catIndex].options[optIndex][field] = value;
                setConfig({ ...config, pricing: { ...config.pricing, categories: newCategories } });
            };

            return (
                <div className="fixed inset-0 bg-black/98 z-[5000] flex items-center justify-center p-4 animate-in fade-in duration-300" onClick={onClose}>
                    <div onClick={e => e.stopPropagation()} className="bg-zinc-950 border border-zinc-800 w-full max-w-6xl rounded-[3rem] p-10 max-h-[90vh] overflow-y-auto no-scrollbar shadow-2xl space-y-10">
                        <div className="flex justify-between items-center border-b border-zinc-900 pb-8"><h2 className="text-3xl font-black text-amber-500 italic uppercase">管理后台</h2><button onClick={onClose} className="p-3 text-zinc-600 hover:text-white transition-colors"><X size={36}/></button></div>
                        <div className="flex gap-4">
                            {['price', 'about', 'pay'].map(t => (
                                <button key={t} onClick={() => setTab(t)} className={`px-8 py-3 rounded-2xl text-[11px] font-black uppercase transition-all ${tab === t ? 'bg-indigo-600 text-white shadow-xl' : 'bg-zinc-900 text-zinc-600'}`}>{t === 'price' ? '资费管理' : t === 'about' ? '介绍修改' : '收款码'}</button>
                            ))}
                        </div>
                        <div className="min-h-[40vh] text-white">
                            {tab === 'price' && (
                                <div className="space-y-10 animate-fade-up">
                                    <div className="flex justify-between items-center"><h3 className="text-emerald-500 font-black uppercase text-xs tracking-widest text-center text-center">方案库</h3><button onClick={() => setConfig({...config, pricing: {...config.pricing, categories: [...config.pricing.categories, {id: `c_${Date.now()}`, name: '新服务分类', options: []}]}})} className="bg-indigo-600 px-5 py-2 rounded-xl text-[10px] font-black shadow-lg">+ 增加分类</button></div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-10 text-center">
                                        {config.pricing.categories.map((cat, ci) => (
                                            <div key={cat.id} className="bg-zinc-900/40 p-8 rounded-[3rem] border border-zinc-800 relative group">
                                                <button onClick={() => setConfig({...config, pricing: {...config.pricing, categories: config.pricing.categories.filter((_, i) => i !== ci)}})} className="absolute top-6 right-6 text-red-500 opacity-20 group-hover:opacity-100 transition-opacity p-2 text-center text-center text-center"><Trash2 size={20}/></button>
                                                <input className="bg-transparent border-b border-zinc-800 text-xl font-black w-full pb-2 mb-6 outline-none text-white focus:border-indigo-600 transition-all text-center" value={cat.name} onChange={e => updatePricing(ci, null, 'name', e.target.value)} />
                                                <div className="space-y-4">
                                                    {cat.options.map((opt, oi) => (
                                                        <div key={oi} className="bg-black/50 p-6 rounded-3xl border border-white/5 space-y-4 relative text-left">
                                                            <div className="grid grid-cols-2 gap-4">
                                                                <div className="space-y-1"><label className="text-[7px] text-zinc-600 font-bold uppercase text-center">价格</label><input className="w-full bg-zinc-800 px-3 py-2 rounded-lg text-sm text-white outline-none" value={opt.price} onChange={e => updatePricing(ci, oi, 'price', e.target.value)} /></div>
                                                                <div className="space-y-1"><label className="text-[7px] text-zinc-600 font-bold uppercase text-center">周期</label><input className="w-full bg-zinc-800 px-3 py-2 rounded-lg text-sm text-white outline-none" value={opt.unit} onChange={e => updatePricing(ci, oi, 'unit', e.target.value)} /></div>
                                                            </div>
                                                            <textarea className="w-full bg-zinc-800 px-3 py-2 rounded-lg text-[10px] h-16 resize-none text-white outline-none" value={opt.desc} placeholder="详细描述文字" onChange={e => updatePricing(ci, oi, 'desc', e.target.value)} />
                                                            <button onClick={() => { let nc = JSON.parse(JSON.stringify(config.pricing.categories)); nc[ci].options = nc[ci].options.filter((_, i) => i !== oi); setConfig({...config, pricing: {...config.pricing, categories: nc}}); }} className="text-[8px] text-red-500 font-black uppercase text-center w-full pt-2">移除</button>
                                                        </div>
                                                    ))}
                                                    <button onClick={() => { let nc = JSON.parse(JSON.stringify(config.pricing.categories)); nc[ci].options.push({price: '99', unit: '周', desc: '新计划描述'}); setConfig({...config, pricing: {...config.pricing, categories: nc}}); }} className="w-full py-4 border border-dashed border-zinc-800 rounded-2xl text-[9px] text-zinc-700 hover:text-white transition-colors uppercase">+ 增加子项</button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                            {tab === 'about' && (
                                <div className="space-y-12 animate-fade-up max-w-4xl text-left">
                                    <div className="space-y-8">
                                        <div className="space-y-2 text-center"><label className="text-[10px] text-zinc-600 font-black uppercase tracking-widest italic">主页标题</label><input className="w-full bg-zinc-900 border border-zinc-800 rounded-2xl px-6 py-4 text-xl font-black italic shadow-inner text-white outline-none focus:ring-1 ring-indigo-500 transition-all text-center" value={config.about.title} onChange={e => setConfig({...config, about: {...config.about, title: e.target.value}})} /></div>
                                        <div className="space-y-2 text-center"><label className="text-[10px] text-zinc-600 font-black uppercase tracking-widest italic">详细描述</label><textarea className="w-full bg-zinc-900 border border-zinc-800 rounded-2xl px-6 py-4 h-64 leading-[2.2] text-sm resize-none italic shadow-inner text-white outline-none focus:ring-1 ring-indigo-500 transition-all text-center" value={config.about.description} onChange={e => setConfig({...config, about: {...config.about, description: e.target.value}})} /></div>
                                    </div>
                                </div>
                            )}
                            {tab === 'pay' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-16 animate-fade-up">
                                    {['wechatQr', 'alipayQr'].map(t => (
                                        <div key={t} className="p-12 bg-black rounded-[4rem] border border-white/5 flex flex-col items-center gap-10 group text-center text-center">
                                            <div className="w-56 h-56 bg-zinc-900 rounded-[3.5rem] overflow-hidden flex items-center justify-center border-4 border-white/10 group-hover:border-emerald-500/30 transition-all relative">
                                                {config.payment[t] ? <img src={config.payment[t]} className="w-full h-full object-contain p-2" /> : <ImageIcon className="text-zinc-800 text-center" size={64}/>}
                                                <div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity cursor-pointer text-center text-center" onClick={() => (t === 'wechatQr' ? fileRefs.wechat : fileRefs.alipay).current.click()}><Camera size={56} className="text-white"/></div>
                                            </div>
                                            <input ref={t === 'wechatQr' ? fileRefs.wechat : fileRefs.alipay} type="file" hidden accept="image/*" onChange={e => handleFileAction(e, (res) => setConfig(p => ({...p, payment: {...p.payment, [t]: res}})))} />
                                            <p className="text-sm font-black text-zinc-500 uppercase tracking-[0.5em]">{t.includes('wechat')?'微信':'支付宝'}</p>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                        <button onClick={() => saveConfigToCloud(config)} className="w-full py-8 bg-white text-black rounded-[3rem] font-black uppercase shadow-2xl active:scale-95 transition-all text-xl mt-12 tracking-[0.4em] italic text-center text-center">发布同步</button>
                    </div>
                </div>
            );
        }

        // --- App 主程序 ---
        function App() {
            const [user, setUser] = useState(null);
            const [viewMode, setViewMode] = useState('landing'); 
            const [activeTab, setActiveTab] = useState('team'); 
            const [teamFilter, setTeamFilter] = useState('all');
            const [config, setConfig] = useState(INITIAL_CONFIG);
            const [team, setTeam] = useState([]);
            const [searchTerm, setSearchTerm] = useState("");
            const [selectedPerson, setSelectedPerson] = useState(null);
            const [selectedService, setSelectedService] = useState(null);
            const [toast, setToast] = useState(null);
            const [isAdmin, setIsAdmin] = useState(false);
            const [showLogin, setShowLogin] = useState(false);
            const [showAddMember, setShowAddMember] = useState(false);
            const [showMasterConsole, setShowMasterConsole] = useState(false);
            const [deleteConfirm, setDeleteConfirm] = useState(null);
            const [passInput, setPassInput] = useState("");
            const [loading, setLoading] = useState(true);

            const fileRefs = { wechat: useRef(), alipay: useRef(), editAvatar: useRef() };

            // 极速加载逻辑：挂载即尝试关闭 loader
            useEffect(() => {
                const loader = document.getElementById('initial-loader');
                if (loader) {
                    // 不需要等待数据，JS 运行起来就淡出
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 400);
                }
            }, []);

            useEffect(() => {
                const startAuth = async () => {
                    try {
                        const credential = await signInAnonymously(auth);
                        setUser(credential.user);
                    } catch (e) {
                        console.error("Cloud Error", e);
                        setLoading(false);
                    }
                };
                startAuth();
                const unsub = onAuthStateChanged(auth, u => u && setUser(u));
                return () => unsub();
            }, []);

            useEffect(() => {
                if (!user) return;
                const configRef = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'mainConfig');
                const teamColl = collection(db, 'artifacts', appId, 'public', 'data', 'members');

                const unsubConfig = onSnapshot(configRef, (snap) => {
                    if (snap.exists()) setConfig(prev => ({ ...INITIAL_CONFIG, ...snap.data() }));
                    setLoading(false);
                }, () => setLoading(false));

                const unsubTeam = onSnapshot(teamColl, (snap) => {
                    setTeam(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });

                return () => { unsubConfig(); unsubTeam(); };
            }, [user]);

            const commitMemberChange = async (pId, updates) => {
                if (selectedPerson?.id === pId) setSelectedPerson(prev => ({ ...prev, ...updates }));
                setTeam(prev => prev.map(m => m.id === pId ? { ...m, ...updates } : m));
                try { await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'members', pId), updates); } catch(e) {}
            };

            const handleFileAction = (e, callback) => {
                const file = e.target.files[0];
                if (!file) return;
                if (file.size > 850000) return setToast({ message: "文件需小于 800KB", type: "error" });
                const reader = new FileReader();
                reader.onloadend = () => { callback(reader.result); e.target.value = ""; };
                reader.readAsDataURL(file);
            };

            const filteredTeam = useMemo(() => {
                let list = team.filter(m => (m.name || "").toLowerCase().includes(searchTerm.toLowerCase()));
                if (teamFilter !== 'all') list = list.filter(m => m.category === teamFilter);
                return list;
            }, [team, searchTerm, teamFilter]);

            // 主渲染逻辑
            return (
                <div className="min-h-screen flex flex-col bg-[#050505] animate-in fade-in duration-300">
                    {viewMode === 'landing' ? (
                        <div className="min-h-screen flex flex-col items-center justify-center text-center p-8 relative bg-[#010101] overflow-hidden">
                            <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(99,102,241,0.06)_0%,transparent_70%)]"></div>
                            <div className="relative z-10 flex flex-col items-center space-y-12">
                                <div className="relative text-center">
                                    <h1 className="text-[8rem] md:text-[12rem] font-shufa text-white tracking-[0.1em] leading-none text-center">{config.landing.mainTitle}</h1>
                                    <div className="absolute -top-6 -right-12 bg-red-900 border-2 border-red-700 p-3 rounded-lg shadow-2xl rotate-6 animate-pulse text-center"><span className="font-shufa writing-vertical text-2xl text-red-50 tracking-[0.2em]">{config.landing.stampText}</span></div>
                                </div>
                                <div className="space-y-6 text-center text-center">
                                    <p className="text-zinc-600 uppercase tracking-[1em] text-[10px] font-black italic text-center">{config.landing.subTitle}</p>
                                    <p className="text-zinc-400 max-w-lg mx-auto leading-loose text-base font-medium italic opacity-80 whitespace-pre-wrap px-6 text-center">{config.landing.description}</p>
                                </div>
                                <button onClick={() => setViewMode('main')} className="group px-16 py-5 bg-white text-black rounded-full font-black text-xl hover:scale-105 shadow-[0_0_80px_rgba(255,255,255,0.15)] uppercase tracking-[0.4em] relative overflow-hidden transition-all active:scale-95 text-center">
                                    <span className="relative z-10">{config.landing.enterButton}</span>
                                    <div className="absolute inset-0 bg-indigo-600 translate-y-full group-hover:translate-y-0 transition-transform duration-500"></div>
                                </button>
                                <p className="text-zinc-900 text-[10px] tracking-[0.6em] font-black uppercase mt-12 text-center">{config.landing.footer}</p>
                            </div>
                        </div>
                    ) : (
                        <div className="flex flex-col min-h-screen">
                            <header className="sticky top-0 z-50 glass-card border-b border-white/5 py-4 px-8 shadow-2xl">
                                <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6 text-center">
                                    <div className="flex items-center gap-4 text-center">
                                        <div className="p-2.5 bg-indigo-600 rounded-xl shadow-2xl transition-all hover:scale-110 cursor-pointer text-center"><Building2 size={20} className="text-white"/></div>
                                        <div className="text-left text-center"><h1 className="text-xl font-black tracking-widest uppercase italic text-center">{config.header.title}</h1><p className="text-[8px] font-bold text-zinc-700 uppercase tracking-[0.4em] text-center">{config.header.subtitle}</p></div>
                                    </div>
                                    <div className="flex items-center bg-black/80 p-1.5 rounded-2xl border border-white/5 shadow-inner text-center">
                                        {['team', 'about', 'price'].map(t => (
                                            <button key={t} onClick={() => { setActiveTab(t); setSelectedPerson(null); }} className={`px-8 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all ${activeTab === t ? 'bg-indigo-600 text-white shadow-xl' : 'text-zinc-600 hover:text-zinc-300'}`}>
                                                {t === 'team' ? '团队' : t === 'about' ? '品牌' : '资费'}
                                            </button>
                                        ))}
                                    </div>
                                    <div className="flex items-center gap-5 text-center">
                                        {isAdmin && <button onClick={() => setShowMasterConsole(true)} className="p-3 bg-amber-600/10 text-amber-500 rounded-full border border-amber-500/30 hover:bg-amber-600 hover:text-black transition-all text-center"><Settings size={18}/></button>}
                                        <button onClick={() => setViewMode('landing')} className="text-[9px] font-black text-zinc-700 hover:text-white uppercase tracking-widest transition-colors italic text-center">断开连接</button>
                                        <button onClick={() => isAdmin ? setIsAdmin(false) : setShowLogin(true)} className={`p-3 rounded-full border transition-all ${isAdmin ? 'bg-amber-600 text-black border-amber-500 shadow-lg shadow-amber-900/40' : 'bg-zinc-900 text-zinc-500 border-white/10'} text-center`}>
                                            {isAdmin ? <ShieldAlert size={18}/> : <Lock size={18}/>}
                                        </button>
                                    </div>
                                </div>
                            </header>

                            <main className="flex-1 overflow-y-auto no-scrollbar pb-32">
                                <div className="max-w-7xl mx-auto px-8 py-16 animate-fade-in">
                                    {activeTab === 'team' && (
                                        <div className="space-y-20 text-center">
                                            <div className="flex flex-col lg:flex-row justify-between items-center gap-10 text-center lg:text-left">
                                                <div className="max-w-3xl space-y-8 text-center lg:text-left text-center">
                                                    <h2 className="text-7xl font-black tracking-tighter text-white italic drop-shadow-2xl text-center lg:text-left">{config.teamPage.title}</h2>
                                                    <div className="flex flex-wrap justify-center lg:justify-start gap-4 text-center">
                                                        {CATEGORIES.map(cat => (
                                                            <button key={cat.id} onClick={() => setTeamFilter(cat.id)} className={`flex items-center gap-3 px-8 py-3 rounded-2xl border border-white/5 text-[11px] font-black uppercase tracking-widest transition-all hover:border-indigo-600 ${teamFilter === cat.id ? 'active-filter' : 'bg-zinc-900/30 text-zinc-600'}`}>{cat.icon} {cat.name}</button>
                                                        ))}
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-5 w-full lg:w-auto text-center">
                                                    <div className="relative flex-1 lg:w-96 shadow-2xl text-center text-center">
                                                        <Search className="absolute left-5 top-1/2 -translate-y-1/2 text-zinc-800" size={16}/>
                                                        <input type="text" placeholder="全局加密检索..." className="w-full bg-zinc-900/60 border border-white/5 rounded-2xl py-5 pl-14 pr-6 text-sm text-white focus:border-indigo-600 transition-all outline-none italic text-center" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />
                                                    </div>
                                                    {isAdmin && <button onClick={() => setShowAddMember(true)} className="p-5 bg-indigo-600 text-white rounded-2xl shadow-2xl hover:scale-105 active:scale-95 transition-all text-center"><Plus size={28}/></button>}
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12 text-center lg:text-left text-center">
                                                {filteredTeam.map((p) => (
                                                    <div key={p.id} className="p-8 rounded-[3.5rem] glass-card transition-all hover:-translate-y-3 overflow-hidden group relative shadow-2xl animate-fade-in text-center lg:text-left">
                                                        <div className={`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-1000 -z-10 ${p.category === 'boss' ? 'boss-card' : 'strict-card'} text-center`}></div>
                                                        {isAdmin && (
                                                            <button onClick={(e) => { e.stopPropagation(); setDeleteConfirm(p.id); }} className="absolute top-6 right-6 p-2.5 bg-red-600/10 text-red-500 rounded-full hover:bg-red-600 hover:text-white transition-all z-20 text-center text-center text-center"><Trash2 size={16}/></button>
                                                        )}
                                                        <div onClick={() => setSelectedPerson(p)} className="cursor-pointer text-center">
                                                            <div className="flex justify-between items-start mb-10 text-center">
                                                                <div className="relative group/av shadow-2xl rounded-3xl overflow-hidden border border-white/10 text-center"><img src={p.photo} className="w-32 h-32 object-cover transition-transform duration-700 group-hover/av:scale-110 text-center" loading="lazy" /><div className="absolute -bottom-4 -right-4 scale-110 text-center"><StatusIndicator status={p.status}/></div></div>
                                                                <div className="text-right space-y-3 pt-2 text-center lg:text-right text-center"><div className={`px-4 py-1.5 rounded-lg text-[9px] font-black uppercase tracking-widest ${p.category === 'boss' ? 'bg-amber-600 text-black shadow-lg' : 'bg-indigo-600 text-white shadow-lg'} text-center`}>级别 {p.category === 'boss' ? 'S+' : 'A'}</div><div className="flex text-amber-500 justify-end text-center text-center"><StarRating rating={p.stars}/></div></div>
                                                            </div>
                                                            <h4 className="text-3xl font-black text-white mb-2 tracking-tighter uppercase italic text-center lg:text-left">{p.name}</h4><p className="text-[11px] font-black text-zinc-700 uppercase tracking-[0.4em] mb-8 text-center lg:text-left text-center">{p.role}</p>
                                                            <div className="bg-black/50 rounded-3xl p-6 text-sm text-zinc-400 italic mb-10 line-clamp-3 leading-relaxed font-serif text-center lg:text-left text-center">“ {p.bio} ”</div>
                                                            <div className="flex items-center justify-between pt-6 border-t border-white/5 font-black font-serif text-center lg:text-left text-center text-center"><div className="flex items-center gap-2 text-rose-600 font-bold italic text-center"><Heart size={16} fill="currentColor"/><span className="text-base text-center">{p.likes || 0}</span></div><div className="text-[10px] font-black text-zinc-800 uppercase flex items-center gap-2 group-hover:text-white transition-all tracking-widest italic text-center">详细档案 <ChevronRight size={14}/></div></div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {/* 品牌页和价格页保持一致逻辑 */}
                                    {activeTab === 'about' && (
                                        <div className="max-w-4xl mx-auto space-y-32 animate-fade-in text-center text-center text-center">
                                            <div className="space-y-10 text-center text-center">
                                                <h2 className="text-8xl font-black italic text-white tracking-tighter uppercase opacity-90 text-center">{config.about.title}</h2>
                                                <p className="text-zinc-500 leading-[2.4] italic text-xl px-12 font-medium whitespace-pre-wrap text-center text-center">{config.about.description}</p>
                                            </div>
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-10 px-8 text-center">
                                                {config.about.achievements?.map((a, i) => (
                                                    <div key={i} className="glass-card p-12 rounded-[3.5rem] shadow-2xl group hover:scale-105 transition-transform text-center"><p className="text-[11px] font-black text-zinc-700 uppercase tracking-[0.4em] mb-5 italic text-center">{a.label}</p><div className="text-6xl font-black text-white tracking-tighter text-center">{a.value}<span className="text-lg text-indigo-500 ml-2 italic font-bold text-center">{a.unit}</span></div></div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {activeTab === 'price' && (
                                        <div className="space-y-24 animate-fade-in text-center text-center">
                                            <div className="space-y-4 text-center"><h2 className="text-7xl font-black italic text-white tracking-tighter uppercase text-center">{config.pricing.title}</h2><p className="text-zinc-800 text-sm font-black uppercase tracking-[1em] opacity-40 text-center text-center text-center">协议资费明细</p></div>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-6xl mx-auto text-center text-center">
                                                {config.pricing.categories.map(cat => (
                                                    <div key={cat.id} className="glass-card rounded-[4rem] overflow-hidden shadow-2xl relative text-center">
                                                        <div className="p-10 bg-white/[0.02] font-black text-white text-xl uppercase tracking-[0.4em] italic border-b border-white/5 text-center text-center">{cat.name}</div>
                                                        <div className="p-10 space-y-10 text-center">
                                                            {cat.options.map((opt, i) => (
                                                                <div key={i} className="p-10 rounded-[3rem] border border-white/5 bg-black/60 group relative overflow-hidden transition-all hover:bg-black/40 text-center">
                                                                    <div className="flex flex-col sm:flex-row justify-between items-center mb-8 relative z-10 gap-3 text-center text-center">
                                                                        <div className={`px-5 py-2 bg-indigo-900/20 text-indigo-400 text-[10px] font-black rounded-xl uppercase border border-indigo-500/20 shadow-xl tracking-widest italic text-center`}>V3 方案</div>
                                                                        <span className="text-4xl text-white font-black tracking-tighter group-hover:text-indigo-500 transition-colors text-center">￥{opt.price}<span className="text-xs text-zinc-800 ml-2 text-center text-center">/ {opt.unit || '周'}</span></span>
                                                                    </div>
                                                                    <p className="text-base text-zinc-500 italic mb-10 leading-relaxed font-serif text-center text-center">“ {opt.desc} ”</p>
                                                                    <button onClick={() => setSelectedService({ catName: cat.name, opt })} className="w-full py-6 bg-white text-black rounded-[2.5rem] font-black text-[13px] uppercase tracking-[0.3em] shadow-2xl active:scale-95 transition-all hover:bg-zinc-200 text-center text-center">立即支付</button>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </main>
                        </div>
                    )}

                    {/* --- 交互层弹窗 --- */}
                    <div id="interaction-portals">
                        {/* 详情查看 */}
                        {selectedPerson && (
                            <div className="fixed inset-0 bg-black/98 flex items-center justify-center p-4 z-[800] animate-in fade-in duration-300" onClick={() => setSelectedPerson(null)}>
                                <div className={`w-full max-w-6xl rounded-[4rem] border shadow-[0_0_100px_rgba(0,0,0,1)] flex flex-col md:flex-row overflow-hidden glass-card transition-all duration-700 ${selectedPerson.category === 'boss' ? 'boss-card shadow-amber-900/10' : 'strict-card shadow-indigo-900/10'} text-center`} onClick={e => e.stopPropagation()}>
                                    <div className="md:w-[42%] p-10 md:p-16 bg-black/70 flex flex-col items-center border-r border-white/5 text-center relative overflow-hidden text-center">
                                        <div className="relative mb-10 group cursor-pointer shadow-2xl rounded-[4rem] overflow-hidden border-8 border-white/5 group-hover:border-indigo-600 transition-all duration-700 text-center" onClick={() => isAdmin && fileRefs.editAvatar.current.click()}>
                                            <img src={selectedPerson.photo} className="w-48 h-48 md:w-64 md:h-64 object-cover scale-105 text-center text-center" />
                                            {isAdmin && <div className="absolute inset-0 bg-black/80 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all text-center text-center"><Camera size={48} className="text-white text-center"/></div>}
                                            <div className="absolute -bottom-4 -right-4 scale-[1.3] text-center text-center"><StatusIndicator status={selectedPerson.status}/></div>
                                        </div>
                                        <input ref={fileRefs.editAvatar} type="file" hidden accept="image/*" onChange={e => handleFileAction(e, (res) => commitMemberChange(selectedPerson.id, {photo: res}))} />
                                        <div className="w-full space-y-4 text-center font-shufa text-center text-center">
                                            {isAdmin ? (
                                                <input className="w-full bg-zinc-900 border border-zinc-800 text-center text-3xl font-black italic rounded-2xl py-3 outline-none text-white focus:ring-2 ring-indigo-500 text-center text-center" value={selectedPerson.name} onChange={e => commitMemberChange(selectedPerson.id, {name: e.target.value})} />
                                            ) : (
                                                <h2 className="text-5xl font-black text-white italic tracking-tighter uppercase text-center text-center text-center">{selectedPerson.name}</h2>
                                            )}
                                            <p className="text-zinc-600 text-[11px] font-black uppercase tracking-[0.5em] italic text-center text-center">{selectedPerson.role}</p>
                                        </div>
                                        <div className="mt-12 w-full flex flex-col gap-5 font-serif italic text-center">
                                            <button onClick={() => { setActiveTab('price'); setSelectedPerson(null); }} className="w-full py-6 bg-white text-black rounded-[2.5rem] font-black uppercase tracking-[0.2em] text-xs hover:bg-zinc-200 active:scale-95 transition-all shadow-2xl text-center text-center">立即支付</button>
                                            <button onClick={() => setSelectedPerson(null)} className="text-[9px] font-black text-zinc-700 hover:text-white uppercase tracking-[0.5em] transition-colors text-center text-center">返回列表</button>
                                        </div>
                                    </div>
                                    <div className="md:w-[58%] p-10 md:p-16 overflow-y-auto relative no-scrollbar bg-black/40 shadow-inner text-center text-center">
                                        <button onClick={() => setSelectedPerson(null)} className="absolute top-8 right-8 text-zinc-800 hover:text-white transition-colors p-4 bg-zinc-950 rounded-full border border-white/5 font-shufa text-center text-center text-center"><X size={32}/></button>
                                        <div className="space-y-12 text-center text-center text-center">
                                            <h3 className="text-[10px] font-black uppercase text-indigo-600 underline decoration-indigo-900 decoration-8 underline-offset-[1rem] tracking-[0.6em] italic mb-8 text-center lg:text-left text-center">监督员档案</h3>
                                            <div className="bg-white/[0.01] p-10 rounded-[3rem] border border-white/5 shadow-inner text-white min-h-[200px] font-serif text-center text-center">
                                                {isAdmin ? (
                                                    <textarea className="w-full bg-transparent text-zinc-300 leading-[2.6] text-base font-medium italic h-64 outline-none resize-none no-scrollbar focus:ring-1 ring-indigo-500/10 rounded-lg p-4 text-center text-center" value={selectedPerson.bio} onChange={e => commitMemberChange(selectedPerson.id, {bio: e.target.value})} />
                                                ) : (
                                                    <p className="text-zinc-300 leading-[2.6] text-lg font-medium italic whitespace-pre-wrap px-4 text-center lg:text-left text-center text-center">“ {selectedPerson.bio} ”</p>
                                                )}
                                            </div>
                                            <div className="grid grid-cols-2 gap-6 pt-2 font-shufa text-center items-center text-center">
                                                <div className="p-6 rounded-[2.5rem] bg-zinc-950/60 border border-white/5 flex flex-col gap-4 shadow-xl text-center items-center hover:bg-zinc-900 transition-colors text-center text-center text-center text-center text-center text-center"><ShieldCheck size={32} className="text-indigo-50 text-center"/><p className="text-[9px] font-black text-white uppercase tracking-widest text-center text-center">隐私保护</p></div>
                                                <div className="p-6 rounded-[2.5rem] bg-zinc-950/60 border border-white/5 flex flex-col gap-4 shadow-xl text-center items-center hover:bg-zinc-900 transition-colors text-center text-center text-center text-center text-center text-center"><Zap size={32} className="text-amber-500 text-center"/><p className="text-[9px] font-black text-white uppercase tracking-widest text-center text-center">极速响应</p></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* 支付终端 */}
                        {selectedService && (
                            <div className="fixed inset-0 bg-black/98 flex items-center justify-center p-6 z-[20000] animate-in fade-in zoom-in duration-300" onClick={() => setSelectedService(null)}>
                                <div className="glass-card w-full max-w-xl rounded-[4rem] overflow-hidden p-12 text-center space-y-12 shadow-[0_0_200px_rgba(99,102,241,0.25)] border-indigo-600/20 relative text-center text-center text-center" onClick={e => e.stopPropagation()}>
                                    <button onClick={() => setSelectedService(null)} className="absolute top-8 left-8 text-zinc-600 hover:text-white transition-colors p-3 bg-zinc-950 rounded-full border border-white/5 shadow-2xl flex items-center gap-2 group transition-all text-center text-center">
                                        <ArrowLeft size={20} className="group-hover:-translate-x-1 transition-transform text-center" />
                                        <span className="text-[9px] font-black uppercase tracking-widest hidden sm:block text-center text-center">返回</span>
                                    </button>
                                    <div className="space-y-3 text-center text-center">
                                        <h3 className="text-4xl font-black italic text-white tracking-tighter uppercase tracking-[0.1em] font-shufa text-center text-center">支付中心</h3>
                                        <p className="text-zinc-600 text-[10px] font-bold uppercase tracking-widest text-center">官方加密支付通道</p>
                                    </div>
                                    <div className="bg-black/90 p-10 rounded-[3rem] border border-white/5 shadow-2xl relative overflow-hidden shadow-black/80 text-center text-center text-center text-center">
                                        <div className="grid grid-cols-2 gap-8 mb-10 text-center text-center">
                                            {['wechatQr', 'alipayQr'].map(t => (
                                                <div key={t} className="space-y-5 text-center group/qr text-center">
                                                    <div className="bg-white p-2.5 rounded-3xl aspect-square flex items-center justify-center shadow-xl overflow-hidden border-4 border-white/10 ring-1 ring-white/20 transition-transform group-hover/qr:scale-105 text-center text-center">
                                                        {config?.payment?.[t] ? <img src={config.payment[t]} className="w-full h-full object-contain p-2 text-center text-center" /> : <div className="flex flex-col items-center gap-2 text-zinc-300 text-center text-center text-center text-center"><QrCode size={48} className="text-center text-center"/><p className="text-[7px] font-black text-zinc-600 uppercase tracking-widest text-center text-center">未上传</p></div>}
                                                    </div>
                                                    <p className="text-[10px] font-black text-zinc-500 uppercase tracking-[0.4em] italic text-center transition-colors group-hover/qr:text-white text-center text-center">{t.includes('wechat')?'微信':'支付宝'}</p>
                                                </div>
                                            ))}
                                        </div>
                                        <p className="text-[9px] text-zinc-600 font-black italic tracking-widest opacity-60 text-center uppercase font-serif text-center text-center">请保存截图以激活契约</p>
                                    </div>
                                    <button onClick={() => setSelectedService(null)} className="text-[10px] font-black text-zinc-800 hover:text-white transition-all uppercase tracking-[0.6em] italic active:scale-95 font-serif text-center hover:scale-110 text-center text-center text-center text-center">关闭窗口</button>
                                </div>
                            </div>
                        )}

                        {/* 管理员登录 */}
                        {showLogin && (
                            <div className="fixed inset-0 bg-black/99 flex items-center justify-center p-8 z-[10000] animate-in zoom-in duration-300 text-center text-center">
                                <div className="w-full max-w-sm p-14 glass-card rounded-[3.5rem] space-y-14 text-center shadow-indigo-900/20 text-center text-center text-center">
                                    <div className="space-y-6 text-center font-shufa text-center text-center"><ShieldAlert size={64} className="text-indigo-600 mx-auto animate-pulse text-center text-center"/><h2 className="text-2xl font-black uppercase text-white italic tracking-[0.4em] text-center text-center text-center">授权登录</h2></div>
                                    <form onSubmit={handleLogin} className="space-y-10 text-center font-serif text-center text-center">
                                        <input type="password" name="p" className="w-full bg-black/80 border border-white/10 rounded-2xl px-8 py-5 text-center outline-none text-white font-black tracking-[1em] focus:border-indigo-600 transition-all text-xl text-center shadow-inner text-center text-center" placeholder="••••" value={passInput} onChange={e => setPassInput(e.target.value)} autoFocus />
                                        <button className="w-full py-5 bg-white text-black rounded-[2.5rem] font-black uppercase shadow-2xl hover:bg-zinc-100 active:scale-95 transition-all text-xs tracking-[0.4em] text-center text-center text-center">确认进入</button>
                                        <button type="button" onClick={() => setShowLogin(false)} className="text-[10px] font-black text-zinc-700 hover:text-white transition-all tracking-[0.6em] uppercase italic text-center text-center">返回</button>
                                    </form>
                                </div>
                            </div>
                        )}

                        {/* 档案删除确认 */}
                        {deleteConfirm && (
                            <div className="fixed inset-0 bg-black/99 flex items-center justify-center p-8 z-[12000] animate-in zoom-in duration-300 text-center text-center">
                                <div className="glass-card w-full max-sm:w-full max-w-sm p-12 rounded-[3.5rem] text-center space-y-8 shadow-2xl border border-red-900/40 shadow-red-900/20 text-center text-center">
                                    <div className="w-20 h-20 bg-red-600/10 rounded-full flex items-center justify-center mx-auto text-red-600 animate-bounce shadow-xl text-center text-center"><AlertTriangle size={56} className="text-center text-center"/></div>
                                    <div className="space-y-4 text-center text-center text-center"><h3 className="text-2xl font-black italic text-white uppercase tracking-tighter text-center">档案销毁</h3><p className="text-[10px] text-zinc-600 font-bold uppercase tracking-[0.2em] leading-relaxed italic text-center text-center text-center">确定彻底注销此项档案吗？</p></div>
                                    <div className="flex flex-col gap-4 pt-4 font-serif text-center text-center text-center">
                                        <button onClick={() => handleArchiveDelete(deleteConfirm)} className="w-full py-5 bg-red-600 text-white rounded-[2rem] font-black uppercase tracking-[0.4em] hover:bg-red-500 shadow-2xl active:scale-95 transition-all text-center text-center">执行注销</button>
                                        <button onClick={() => setDeleteConfirm(null)} className="text-[10px] font-black text-zinc-700 hover:text-white transition-all tracking-[0.6em] uppercase italic text-center text-center text-center">中止</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {showMasterConsole && <MasterConsoleModal config={config} setConfig={setConfig} onClose={() => setShowMasterConsole(false)} saveConfigToCloud={async (newCfg) => { try { await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'mainConfig'), newCfg); setToast({message: "同步成功", type: "success"}); } catch (e) { setToast({message: "同步失败", type: "error"}); } }} handleFileAction={handleFileAction} fileRefs={fileRefs} />}
                        {showAddMember && <AddMemberModal onClose={() => setShowAddMember(false)} onAdd={handleAddNewMember} handleFileAction={handleFileAction} />}
                    </div>

                    {toast && <ToastComp msg={toast} onClose={() => setToast(null)} />}
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>